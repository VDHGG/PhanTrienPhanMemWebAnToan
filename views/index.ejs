<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>NEM Shoe Store</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    /* ===== SLIDER ===== */
    .slider {
      position: relative;
      width: 100%;
      max-width: 1200px; /* bigger slider */
      height: 480px; /* increased height */
      margin: 0 auto 30px;
      overflow: hidden;
      border-radius: 14px;
      box-shadow: 0 20px 50px rgba(2,6,23,0.6);
    }
    .slides { position:relative; width:100%; height:100%; }
    .slides img {
      position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover;
      opacity:0; transition:opacity 800ms ease; border-radius:14px;
    }
    .slides img.active{ opacity:1 }

    /* ===== PRODUCTS ===== */
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 25px;
    }
    .product {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      width: 230px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .product img {
      width: 100%;
      border-radius: 8px;
    }


    /* ===== POSTS ===== */
    .posts {
      margin-top: 60px;
      text-align: center;
    }
    .post {
      display: inline-block;
      width: 250px;
      margin: 10px;
      vertical-align: top;
      text-align: left;
      background: #fff;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .post img {
      width: 100%;
      border-radius: 8px;
    }
  </style>
</head>

<%- include('partials/header') %>

  <div class="site-wrapper">

  <!-- ðŸ  SLIDER -->
  <div class="slider">
    <div class="slides">
      <img src="/images/banner1.jpg" alt="Banner 1">
      <img src="/images/banner2.jpg" alt="Banner 2">
      <img src="/images/banner3.jpg" alt="Banner 3">
      <img src="/images/banner3.jpg" alt="Banner 1">
      <img src="/images/banner2.jpg" alt="Banner 2">
      <img src="/images/banner1.jpg" alt="Banner 1">
      <img src="/images/banner1.jpg" alt="Banner 1">
      <img src="/images/banner1.jpg" alt="Banner 1">
      <img src="/images/banner3.jpg" alt="Banner 3">
    </div>
  </div>

<!-- ðŸ¥¿ DANH SÃCH Sáº¢N PHáº¨M -->
  <h1 style="text-align:center; margin-top:20px">Bá»™ SÆ°u Sáº£n Pháº©m</h1>
  <div class="grid">
    <% products.slice(0, 20).forEach(product => { %>
      <%
        // TÃ­nh giÃ¡ sau giáº£m tá»« DB: price_after = price * (1 - discount/100)
        const price_after = product.price * (1 - (product.discount || 0) / 100);
      %>
      <div class="card">
        <% if (product.discount && product.discount > 0) { %>
          <div class="ribbon"><%= Math.round(product.discount) %>% OFF</div>
        <% } %>
        <div class="thumb">
          <a href="/products/<%= product.product_id %>">
            <img src="/<%= product.image %>" alt="<%= product.name %>">
          </a>
        </div>
        <div class="meta">
          <div class="title"><a href="/products/<%= product.product_id %>" style="color:inherit;text-decoration:none"><%= product.name %></a></div>
          <div class="price"><%= price_after.toLocaleString('vi-VN') %> Ä‘ <span class="old-price"><%= product.price.toLocaleString('vi-VN') %> Ä‘</span></div>
        </div>
      </div>
    <% }) %>
  </div>

  <!-- ðŸ“° TIN Tá»¨C -->
<% if (typeof posts !== 'undefined' && posts.length > 0) { %>
  <div class="posts">
    <h2>Tin tá»©c má»›i nháº¥t</h2>
    <% posts.forEach(post => { %>
      <div class="post">
        <img src="/<%= post.image %>" alt="<%= post.title %>">
        <h4 style="color:var(--accent)"><%= post.title %></h4>
        <p style="color:var(--muted);font-size:14px;min-height:50px"><%= post.content.substring(0, 60) %>...</p>
      </div>
    <% }) %>
  </div>
<% } %>

  <script>
    // Simple fade carousel: change image every 5s, pause on hover
    (function(){
      const slider = document.querySelector('.slider');
      const slides = document.querySelectorAll('.slides img');
      if (!slides || slides.length === 0) return;
      let current = 0;
      slides.forEach((img, i) => {
        img.classList.toggle('active', i === 0);
      });

      function show(index){
        slides.forEach((img, i) => img.classList.toggle('active', i === index));
      }

      let timer = setInterval(() => {
        current = (current + 1) % slides.length;
        show(current);
      }, 5000); // 5000ms = 5s

      if (slider) {
        slider.addEventListener('mouseenter', () => { clearInterval(timer); });
        slider.addEventListener('mouseleave', () => {
          clearInterval(timer);
          timer = setInterval(() => {
            current = (current + 1) % slides.length;
            show(current);
          }, 5000);
        });
      }
    })();
  </script>

<%- include('partials/footer') %>

</body>
</html>
